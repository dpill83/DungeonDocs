# Incorporate Spells into DungeonDocs (revised)

## Current state

- **420 spell pages** exist in [docs/dnd2024/spells/](docs/dnd2024/spells/) (e.g. [eldritch-blast.md](docs/dnd2024/spells/eldritch-blast.md), [fireball.md](docs/dnd2024/spells/fireball.md)), generated by [scripts/txt_to_mkdocs.py](scripts/txt_to_mkdocs.py).
- **No Spells section in nav**; spell content is inconsistent—many pages lack Source, school/level, casting time, range, components, and duration in a consistent block.
- **Eight school category pages already exist**: [abjuration-school.md](docs/dnd2024/spells/abjuration-school.md), [conjuration-school.md](docs/dnd2024/spells/conjuration-school.md), [divination-school.md](docs/dnd2024/spells/divination-school.md), [enchantment-school.md](docs/dnd2024/spells/enchantment-school.md), [evocation-school.md](docs/dnd2024/spells/evocation-school.md), [illusion-school.md](docs/dnd2024/spells/illusion-school.md), [necromancy-school.md](docs/dnd2024/spells/necromancy-school.md), [transmutation-school.md](docs/dnd2024/spells/transmutation-school.md). They were generated by the same script but currently have broken formatting (raw rows instead of a proper markdown table, spell names not linked). They can be used as the nav targets and optionally regenerated with proper table + links.
- **Class spell-list pages** (e.g. [wizard spell-list.md](docs/dnd2024/classes/wizard/spell-list.md), [warlock spell-list.md](docs/dnd2024/classes/warlock/spell-list.md)) already contain tables with Name, School, Spell Lists, Casting Time, Range, Components, Duration—these can be used as the source of truth to build the All Spells table and to enrich individual spell pages.

## Navigation

In [mkdocs.yml](mkdocs.yml), add a **Spells** section (e.g. after Feats, before Species) with **nine entries**—no per-spell listing:

- **All Spells** → `dnd2024/spells/index.md`
- **Abjuration Spells** → `dnd2024/spells/abjuration-school.md`
- **Conjuration Spells** → `dnd2024/spells/conjuration-school.md`
- **Divination Spells** → `dnd2024/spells/divination-school.md`
- **Enchantment Spells** → `dnd2024/spells/enchantment-school.md`
- **Evocation Spells** → `dnd2024/spells/evocation-school.md`
- **Illusion Spells** → `dnd2024/spells/illusion-school.md`
- **Necromancy Spells** → `dnd2024/spells/necromancy-school.md`
- **Transmutation Spells** → `dnd2024/spells/transmutation-school.md`

Spells that do not map to one of these eight schools can be listed only on All Spells (or assigned a convention, e.g. "Other").

## All Spells page (dnd2024/spells/index.md)

- **Tabs by spell level**: one tab per level so users can switch between Cantrip, 1st Level, 2nd Level, … 9th Level (10 tabs total).
- **Within each tab**: the same **table** with columns **Name** (link to spell page), **School**, **Spell lists**, **Casting Time**, **Range**, **Components**, **Duration**, filtered to that level.
- Spell names link to the existing spell pages (e.g. `[Eldritch Blast](eldritch-blast.md)`).
- **Implementation**: Material for MkDocs supports content tabs with `=== "Tab label"` syntax (needs `pymdownx.tabbed` in `markdown_extensions` if not already present). The script that builds the merged spell data outputs one tab per level; each tab’s content is the markdown table for that level.
- Table content is **script-generated** from merged class spell-list data; the same dataset drives the eight school pages and (optionally) the structured block on each spell page.

## Eight school pages (existing *-school.md files)

- **Use existing files**: `abjuration-school.md`, `conjuration-school.md`, `divination-school.md`, `enchantment-school.md`, `evocation-school.md`, `illusion-school.md`, `necromancy-school.md`, `transmutation-school.md`.
- **Tabs by spell level** (same as All Spells): Cantrip, 1st Level, 2nd Level, … 9th Level. Within each tab: the same table (Name with link, School, Spell lists, Casting Time, Range, Components, Duration), **filtered to that school and that level**.
- Each page can include a short intro and a link back to All Spells. The current content is poorly formatted (raw rows, no table, no links); the script that builds the All Spells table can **regenerate** these eight files with level tabs and proper markdown tables and spell-name links.

## Individual spell page format

Each spell page should follow this structure (as in your Eldritch Blast example):

1. **Title** (e.g. `# Eldritch Blast`)
2. **Source** (e.g. `Source: Player's Handbook`)
3. **School, level, and who it's for** (e.g. `Evocation Cantrip (Warlock)`)
4. **Casting details** (Casting Time, Range, Components, Duration)
5. **Description** (main text)
6. **Optional subsections** (e.g. "Cantrip Upgrade.", "Using a Higher-Level Spell Slot.")

Example target content:

```markdown
# Eldritch Blast

Source: Player's Handbook

Evocation Cantrip (Warlock)

Casting Time: Action
Range: 120 feet
Components: V, S
Duration: Instantaneous

You hurl a beam of crackling energy...

Cantrip Upgrade. The spell creates two beams at level 5...
```

- **Data source for the structured block**: Merge from all class spell-list tables (level from `## Cantrips` / `## 1st-Level Spells` etc., plus School, Spell Lists, Casting Time, Range, Components, Duration). Map table spell name to existing spell filename (slug) so we know which page to update.
- **Source**: May need a default (e.g. "Player's Handbook") or a small override list; if the wiki/scrape has source, the generator can be extended to capture it.
- **Implementation**: Extend [scripts/txt_to_mkdocs.py](scripts/txt_to_mkdocs.py) (or add a post-process script) to write this block into each spell `.md` when generating, or run a one-time pass that injects the block from the merged spell table + source data.

## Data flow (recommended)

- **Single script** (e.g. in `scripts/`): Parse all `dnd2024/classes/*/spell-list.md`, extract level from `##` headers and rows from tables; merge by spell name (normalize to slug using existing spell filenames). Output: one merged dataset (spell → school, level, spell lists, casting time, range, components, duration).
- From that dataset: generate `index.md` (level tabs, each with full table and links), **regenerate** the existing `*-school.md` files with **level tabs** (Cantrip … 9th) and proper markdown tables and spell-name links per tab, and optionally update each spell `.md` with the structured header block and Source.

## Summary

| Item | Action |
|------|--------|
| Nav | Add Spells with 9 entries: All Spells + 8 school pages (no per-spell nav). |
| All Spells | Tabs by level (Cantrip, 1st–9th); each tab has the table: Name (link), School, Spell lists, Casting Time, Range, Components, Duration. |
| School pages | Use existing *-school.md files in nav; regenerate with level tabs (Cantrip … 9th) + proper table + links per tab. |
| Spell pages | Add Source; add "School Level (Lists)"; add Casting Time, Range, Components, Duration; keep description and subsections. Use merged spell-list data + optional source list. |

## Files to touch

- **[mkdocs.yml](mkdocs.yml)** – add Spells nav block with 9 entries; add `pymdownx.tabbed` to `markdown_extensions` if needed for level tabs.
- **docs/dnd2024/spells/index.md** – All Spells page with level tabs (Cantrip, 1st Level … 9th Level), each tab containing the table (script-generated).
- **docs/dnd2024/spells/abjuration-school.md** … **transmutation-school.md** – 8 school pages (already exist; regenerate with level tabs + proper table + links per tab).
- **scripts/** – add or extend a script to parse class spell-list tables, merge spell data, generate index + school pages, and optionally enrich individual spell `.md` files.
- **docs/dnd2024/spells/*.md** (individual spells) – optionally update to the new format (Source + structured block); can be done incrementally or in one pass from the merged data.
